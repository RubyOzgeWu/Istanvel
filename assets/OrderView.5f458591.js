import{Q as D}from"./QMarkupTable.3bb76791.js";import{E as x,r as w,k as l,l as r,G as C,H as o,J as O,n as e,f as d,ba as P,bd as N,aV as S,I as T,F as y,b1 as v,b0 as u,O as V,aS as B,a$ as b,bx as $,N as q,Q as A}from"./index.3e3ab963.js";import{C as I}from"./ClosePopup.f0775ccb.js";const L={id:"OrderView"},U=e("h2",{class:"orderTitle"},"My Orders",-1),E=e("thead",null,[e("th",null,"Order ID"),e("th",null,"Order"),e("th",null,"Ordered date"),e("th",null,"Total")],-1),F=e("thead",null,[e("th",null,"Order ID"),e("th",null,"Ordered date")],-1),M=["onClick"],z=e("div",{class:"text-h6 details",style:{color:"#A10D48","font-family":"'Ubuntu', sans-serif"}},"Details",-1),G={class:"price text-right",style:{color:"#A10D48","font-size":"1.25rem","font-family":"'Ubuntu', sans-serif","font-weight":"500","margin-top":"10%"}},W={__name:"OrderView",setup(H){const c=x([]),p=x({order:"",name:"",totalPrice:""}),k=w(!1),Q=n=>{const i=n===""?-1:c.findIndex(_=>_._id===n);i!==-1&&(k.value=!0,p.order=c[i].order,p.totalPrice=c[i].totalPrice)};return(async()=>{try{const{data:n}=await N.get("/orders");c.push(...n.result.map(i=>(i.totalPrice=i.order.reduce((_,t)=>{var a,s;return _+(((a=t.tour)==null?void 0:a.price)||((s=t.activity)==null?void 0:s.price))*t.quantity},0),i)))}catch(n){console.log(n),S.fire({icon:"error",title:"failed",text:"Cannot get the order"})}})(),(n,i)=>{const _=T("router-link");return l(),r("div",L,[U,n.$q.screen.gt.sm?(l(),C(D,{key:0},{default:o(()=>[E,e("tbody",null,[(l(!0),r(y,null,v(c,t=>(l(),r("tr",{key:t._id},[e("td",null,u(t._id),1),e("td",null,[e("ul",null,[(l(!0),r(y,null,v(t.order,a=>{var s,m,f;return l(),r("li",{key:a._id},[d(_,{to:(s=a.tour)!=null&&s._id?"/tour/"+((m=a.tour)==null?void 0:m._id):"/activity/"+((f=a.activity)==null?void 0:f._id)},{default:o(()=>{var h,g;return[V(u(((h=a.tour)==null?void 0:h.name)||((g=a.activity)==null?void 0:g.name)),1)]}),_:2},1032,["to"])])}),128))])]),e("td",null,u(new Date(t.date).toLocaleDateString()),1),e("td",null,"NTD "+u(t.totalPrice),1)]))),128))])]),_:1})):O("",!0),n.$q.screen.lt.sm?(l(),C(D,{key:1},{default:o(()=>[F,e("tbody",null,[(l(!0),r(y,null,v(c,t=>(l(),r("tr",{key:t._id},[e("td",{class:"id",onClick:a=>Q(t._id)},u(t._id),9,M),e("td",null,u(new Date(t.date).toLocaleDateString()),1)]))),128))])]),_:1})):O("",!0),e("div",null,[d(P,{modelValue:k.value,"onUpdate:modelValue":i[0]||(i[0]=t=>k.value=t),"full-width":""},{default:o(()=>[d(B,{style:{width:"700px","max-width":"80vw"}},{default:o(()=>[d(b,null,{default:o(()=>[z]),_:1}),d(b,{class:"q-pt-none"},{default:o(()=>[(l(!0),r(y,null,v(p.order,t=>{var a,s,m;return l(),r("div",{key:t._id},[d(_,{to:(a=t.tour)!=null&&a._id?"/tour/"+((s=t.tour)==null?void 0:s._id):"/activity/"+((m=t.activity)==null?void 0:m._id)},{default:o(()=>{var f,h;return[V(u(((f=t.tour)==null?void 0:f.name)||((h=t.activity)==null?void 0:h.name)),1)]}),_:2},1032,["to"])])}),128)),e("p",G,"Total: "+u(p.totalPrice)+" $",1)]),_:1}),d($,{align:"right",class:"text-teal"},{default:o(()=>[q(d(A,{flat:"",label:"OK"},null,512),[[I]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])}}};export{W as default};
